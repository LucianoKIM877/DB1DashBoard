<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2025ë…„ë„ êµ­íšŒë„ì„œê´€ ì›ë¬¸DB êµ¬ì¶•ì‚¬ì—… ëŒ€ì‹œë³´ë“œ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Malgun Gothic', sans-serif;
            background: #f5f5f5;
            min-height: 100vh;
            display: flex;
        }
        
        /* ì‚¬ì´ë“œë°” ìŠ¤íƒ€ì¼ */
        .sidebar {
            width: 250px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            height: 100vh;
            position: fixed;
            left: 0;
            top: 0;
            overflow-y: auto;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
        }
        
        .sidebar-header {
            padding: 30px 20px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .sidebar-header h2 {
            font-size: 18px;
            margin-bottom: 10px;
        }
        
        .sidebar-time {
            font-size: 12px;
            opacity: 0.8;
        }
        
        .sidebar-menu {
            padding: 20px 0;
        }
        
        .menu-item {
            padding: 15px 20px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .menu-item:hover {
            background: rgba(255,255,255,0.1);
        }
        
        .menu-item.active {
            background: rgba(255,255,255,0.2);
            border-left: 4px solid white;
        }
        
        .menu-item i {
            margin-right: 10px;
        }
        
        .submenu {
            background: rgba(0,0,0,0.1);
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }
        
        .submenu.show {
            max-height: 400px;
        }
        
        .submenu-item {
            padding: 12px 20px 12px 50px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
        }
        
        .submenu-item:hover {
            background: rgba(255,255,255,0.1);
        }
        
        .submenu-item.active {
            background: rgba(255,255,255,0.15);
            border-left: 3px solid white;
        }
        
        .arrow {
            transition: transform 0.3s;
            font-size: 12px;
        }
        
        .arrow.down {
            transform: rotate(90deg);
        }
        
        /* ë©”ì¸ ì½˜í…ì¸  ì˜ì—­ */
        .main-content {
            margin-left: 250px;
            flex: 1;
            padding: 20px;
        }
        
        .content-header {
            background: white;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .content-header h1 {
            color: #333;
            font-size: 28px;
            margin-bottom: 10px;
        }
        
        .content-header p {
            color: #666;
            font-size: 16px;
        }
        
        /* í˜ì´ì§€ ì„¹ì…˜ */
        .page-section {
            display: none;
        }
        
        .page-section.active {
            display: block;
            animation: fadeIn 0.5s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* ì¹´ë“œ ìŠ¤íƒ€ì¼ */
        .card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            margin-bottom: 20px;
        }
        
        .card h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        /* í…Œì´ë¸” ìŠ¤íƒ€ì¼ */
        .table-container {
            overflow-x: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #f0f0f0;
        }
        
        th {
            background: #f8f9fa;
            font-weight: bold;
            color: #555;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        tr:hover {
            background: #f8f9fa;
        }
        
        .status-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: bold;
        }
        
        .status-leave {
            background: #f8d7da;
            color: #721c24;
        }
        
        .status-half {
            background: #fff3cd;
            color: #856404;
        }
        
        /* íŒ€ë³„ ì‘ì—… í˜„í™© ê·¸ë¦¬ë“œ */
        .work-status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .team-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            border-left: 5px solid #667eea;
        }

        .team-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e9ecef;
        }

        .team-title {
            font-size: 20px;
            font-weight: bold;
            color: #333;
        }

        .team-count {
            background: #667eea;
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: bold;
        }
        
        .work-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #667eea;
            transition: transform 0.3s, box-shadow 0.3s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        
        .work-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .work-item h4 {
            color: #667eea;
            margin-bottom: 8px;
            font-size: 16px;
        }
        
        .work-item p {
            color: #666;
            font-size: 14px;
            margin: 5px 0;
        }
        
        .serial-number {
            color: #0066cc;
            font-weight: bold;
            font-family: 'Courier New', monospace;
        }
        
        /* í†µê³„ ì¹´ë“œ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            text-align: center;
        }
        
        .stat-card h3 {
            color: #666;
            font-size: 14px;
            margin-bottom: 10px;
        }
        
        .stat-card .number {
            color: #667eea;
            font-size: 32px;
            font-weight: bold;
        }
        
        /* ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
        }
        
        .modal-content {
            position: relative;
            background: white;
            margin: 50px auto;
            padding: 30px;
            width: 90%;
            max-width: 500px;
            border-radius: 15px;
            animation: slideDown 0.3s;
        }
        
        @keyframes slideDown {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .modal-close {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 28px;
            cursor: pointer;
            color: #999;
        }
        
        .modal-close:hover {
            color: #333;
        }
        
        .login-form input {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
        }
        
        .login-btn {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: transform 0.3s;
        }
        
        .login-btn:hover {
            transform: scale(1.02);
        }
        
        /* ê´€ë¦¬ì ì„¹ì…˜ */
        .admin-section {
            display: none;
        }
        
        .admin-section.active {
            display: block;
        }
        
        .upload-section {
            margin-bottom: 20px;
            padding: 20px;
            border: 2px dashed #ddd;
            border-radius: 10px;
            text-align: center;
            position: relative;
        }

        .upload-section.dragover {
            border-color: #667eea;
            background-color: #f8f9ff;
        }
        
        .file-input {
            display: none;
        }
        
        .file-label {
            display: inline-block;
            padding: 12px 24px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 8px;
            cursor: pointer;
            transition: transform 0.3s;
        }
        
        .file-label:hover {
            transform: scale(1.05);
        }

        .file-status {
            margin-top: 10px;
            font-size: 14px;
        }

        .success-message {
            color: #28a745;
            font-weight: bold;
        }

        .error-message {
            color: #dc3545;
            font-weight: bold;
        }

        .file-info {
            color: #666;
            margin-top: 5px;
            font-size: 12px;
        }

        .work-queue-status {
            background: #e7f3ff;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
        }

        .queue-info {
            display: flex;
            justify-content: space-between;
            margin: 5px 0;
            padding: 5px;
            background: white;
            border-radius: 5px;
        }

        .queue-team {
            font-weight: bold;
            color: #667eea;
        }

        .queue-count {
            color: #666;
        }
        
        /* ë°˜ì‘í˜• ë””ìì¸ */
        @media (max-width: 768px) {
            .sidebar {
                width: 200px;
            }
            
            .main-content {
                margin-left: 200px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
    <!-- SheetJS ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¶”ê°€ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <!-- ì‚¬ì´ë“œë°” -->
    <div class="sidebar">
        <div class="sidebar-header">
            <h2>2025ë…„ë„ êµ­íšŒë„ì„œê´€<br>ì›ë¬¸DB êµ¬ì¶•ì‚¬ì—… DBâ… </h2>
            <div class="sidebar-time" id="sidebarTime"></div>
        </div>
        
        <div class="sidebar-menu">
            <div class="menu-item active" onclick="showPage('workers')">
                <span>ğŸ“Š ì‘ì—…ì í˜„í™©</span>
            </div>
            
            <div class="menu-item" onclick="showPage('attendance')">
                <span>â° ì¶œí‡´ê·¼ í˜„í™©</span>
            </div>
            
            <div class="menu-item" onclick="toggleSubmenu(this)">
                <span>ğŸ’¼ ì‘ì—… í˜„í™©</span>
                <span class="arrow">â–¶</span>
            </div>
            <div class="submenu" id="workSubmenu">
                <div class="submenu-item" onclick="showWorkTeam('all')">ì „ì²´ í˜„í™©</div>
                <div class="submenu-item" onclick="showWorkTeam('management')">ì‚¬ì—…ê´€ë¦¬íŒ€</div>
                <div class="submenu-item" onclick="showWorkTeam('scan')">ìŠ¤ìº”íŒ€</div>
                <div class="submenu-item" onclick="showWorkTeam('image')">ì´ë¯¸ì§€ë³´ì •íŒ€</div>
                <div class="submenu-item" onclick="showWorkTeam('toc')">TOCíŒ€</div>
                <div class="submenu-item" onclick="showWorkTeam('check1')">ì ê²€1íŒ€</div>
                <div class="submenu-item" onclick="showWorkTeam('check2')">ì ê²€2íŒ€</div>
                <div class="submenu-item" onclick="showWorkTeam('check3')">ì ê²€3íŒ€</div>
            </div>
            
            <div class="menu-item admin-menu" onclick="showPage('admin')" style="display: none;">
                <span>âš™ï¸ ê´€ë¦¬ì</span>
            </div>
        </div>
    </div>
    
    <!-- ë©”ì¸ ì½˜í…ì¸  -->
    <div class="main-content">
        <!-- ì‘ì—…ì í˜„í™© í˜ì´ì§€ -->
        <div id="workersPage" class="page-section active">
            <div class="content-header">
                <h1>ì‘ì—…ì í˜„í™©</h1>
                <p>ì „ì²´ ì‘ì—…ì ëª©ë¡ ë° ìƒíƒœ</p>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <h3>ì „ì²´ ì‘ì—…ì</h3>
                    <div class="number" id="totalWorkers">0</div>
                </div>
                <div class="stat-card">
                    <h3>í˜„ì¬ ê·¼ë¬´ì¤‘</h3>
                    <div class="number" id="workingCount">0</div>
                </div>
                <div class="stat-card">
                    <h3>íœ´ê°€/ë°˜ì°¨</h3>
                    <div class="number" id="leaveCount">0</div>
                </div>
            </div>
            
            <div class="card">
                <h2>ì‘ì—…ì ëª©ë¡</h2>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>íŒ€</th>
                                <th>ID</th>
                                <th>ì´ë¦„</th>
                                <th>IP</th>
                                <th>ìƒíƒœ</th>
                                <th>í˜„ì¬ ì‘ì—…</th>
                            </tr>
                        </thead>
                        <tbody id="workerTableBody">
                            <!-- ë™ì  ìƒì„± -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- ì¶œí‡´ê·¼ í˜„í™© í˜ì´ì§€ -->
        <div id="attendancePage" class="page-section">
            <div class="content-header">
                <h1>ì¶œí‡´ê·¼ í˜„í™©</h1>
                <p>ì˜¤ëŠ˜ì˜ ì¶œí‡´ê·¼ ê¸°ë¡</p>
            </div>
            
            <div class="card">
                <h2>ì¶œí‡´ê·¼ ê¸°ë¡</h2>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>íŒ€</th>
                                <th>ì´ë¦„</th>
                                <th>ì¶œê·¼ ì‹œê°„</th>
                                <th>í‡´ê·¼ ì‹œê°„</th>
                                <th>ìƒíƒœ</th>
                            </tr>
                        </thead>
                        <tbody id="attendanceTableBody">
                            <!-- ë™ì  ìƒì„± -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- ì‘ì—… í˜„í™© í˜ì´ì§€ -->
        <div id="workPage" class="page-section">
            <div class="content-header">
                <h1 id="workPageTitle">ì „ì²´ ì‘ì—… í˜„í™©</h1>
                <p id="workPageDesc">ëª¨ë“  íŒ€ì˜ ì‘ì—… ì§„í–‰ ìƒí™©</p>
            </div>
            
            <div class="card">
                <div id="workStatusContainer">
                    <!-- ë™ì  ìƒì„± -->
                </div>
            </div>
        </div>
        
        <!-- ê´€ë¦¬ì í˜ì´ì§€ -->
        <div id="adminPage" class="page-section admin-section">
            <div class="content-header">
                <h1>ê´€ë¦¬ì ì„¤ì •</h1>
                <p>ì‹œìŠ¤í…œ ê´€ë¦¬ ë° ë°ì´í„° ì—…ë¡œë“œ</p>
            </div>
            
            <div class="card">
                <h2>ë°ì´í„° ê´€ë¦¬</h2>
                
                <div class="upload-section" id="excelUploadSection">
                    <h3>í†µí•© ì—‘ì…€ íŒŒì¼ ì—…ë¡œë“œ</h3>
                    <input type="file" id="excelFile" class="file-input" accept=".xlsx,.xls">
                    <label for="excelFile" class="file-label">ì—‘ì…€ íŒŒì¼ ì„ íƒ</label>
                    <p style="margin-top: 10px; color: #666;">ì¸ë ¥êµ¬ë¶„, ì—°ì°¨, ì‘ì—…ëŸ‰ ì‹œíŠ¸ê°€ í¬í•¨ëœ ì—‘ì…€ íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì„¸ìš”</p>
                    <div id="excelFileStatus" class="file-status"></div>
                </div>

                <div class="work-queue-status" id="workQueueStatus" style="display: none;">
                    <h3>ì‘ì—… ëŒ€ê¸°ì—´ í˜„í™©</h3>
                    <div id="queueStatusContent"></div>
                </div>
                
                <div style="margin-top: 20px;">
                    <h3>íœ´ê°€/ë°˜ì°¨ ì„¤ì •</h3>
                    <select id="workerSelect" style="padding: 10px; margin: 10px;">
                        <option value="">ì‘ì—…ì ì„ íƒ</option>
                    </select>
                    <select id="leaveType" style="padding: 10px; margin: 10px;">
                        <option value="normal">ì •ìƒ ê·¼ë¬´</option>
                        <option value="ì—°ì°¨">ì—°ì°¨</option>
                        <option value="ì˜¤ì „ë°˜ì°¨">ì˜¤ì „ ë°˜ì°¨</option>
                        <option value="ì˜¤í›„ë°˜ì°¨">ì˜¤í›„ ë°˜ì°¨</option>
                    </select>
                    <input type="date" id="leaveDate" style="padding: 10px; margin: 10px;">
                    <button onclick="setLeave()" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 5px; cursor: pointer;">ì„¤ì •</button>
                </div>

                <div style="margin-top: 20px;">
                    <h3>ì‘ì—… ì œì–´</h3>
                    <button onclick="toggleAllWork()" id="workToggleBtn" style="padding: 10px 20px; background: #dc3545; color: white; border: none; border-radius: 5px; cursor: pointer;">ì „ì²´ ì‘ì—… ì¤‘ë‹¨</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ê´€ë¦¬ì ë¡œê·¸ì¸ ëª¨ë‹¬ -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <span class="modal-close" onclick="closeModal()">&times;</span>
            <h2 style="margin-bottom: 20px;">ê´€ë¦¬ì ë¡œê·¸ì¸</h2>
            <div class="login-form">
                <input type="password" id="adminPassword" placeholder="ë¹„ë°€ë²ˆí˜¸ ì…ë ¥">
                <button class="login-btn" onclick="adminLogin()">ë¡œê·¸ì¸</button>
            </div>
        </div>
    </div>
    
    <script>
        // ì „ì—­ ë³€ìˆ˜
        let workers = [];
        let leaveStatus = {};
        let workQueues = {
            'ì‚¬ì—…ê´€ë¦¬íŒ€': [],
            'ìŠ¤ìº”íŒ€': [],
            'ì´ë¯¸ì§€ë³´ì •íŒ€': [],
            'TOCíŒ€': [],
            'ì ê²€1íŒ€': [],
            'ì ê²€2íŒ€': [],
            'ì ê²€3íŒ€': []
        };
        let workTimers = {};
        let allOffDuty = false;
        let workStopped = false;
        let isAdmin = false;
        let currentTeamView = 'all';
        let currentWorkerAssignments = {};
        
        // ì‹œê°„ ì—…ë°ì´íŠ¸
        function updateTime() {
            const now = new Date();
            const timeString = now.toLocaleString('ko-KR', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: false
            });
            document.getElementById('sidebarTime').textContent = timeString;
        }
        
        // ì—‘ì…€ íŒŒì¼ ì—…ë¡œë“œ ì²˜ë¦¬
        function setupFileUpload() {
            const excelFileInput = document.getElementById('excelFile');
            
            excelFileInput.addEventListener('change', function(e) {
                handleExcelUpload(e);
            });

            // ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì§€ì›
            setupDragAndDrop('excelUploadSection', 'excelFile');
        }

        // ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì„¤ì •
        function setupDragAndDrop(sectionId, inputId) {
            const section = document.getElementById(sectionId);
            const input = document.getElementById(inputId);

            section.addEventListener('dragover', function(e) {
                e.preventDefault();
                section.classList.add('dragover');
            });

            section.addEventListener('dragleave', function(e) {
                e.preventDefault();
                section.classList.remove('dragover');
            });

            section.addEventListener('drop', function(e) {
                e.preventDefault();
                section.classList.remove('dragover');
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    input.files = files;
                    handleExcelUpload({ target: { files: files } });
                }
            });
        }

        // ì—‘ì…€ íŒŒì¼ ì²˜ë¦¬
        function handleExcelUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            const statusElement = document.getElementById('excelFileStatus');
            statusElement.innerHTML = `<div style="color: #007bff;">íŒŒì¼ ì½ëŠ” ì¤‘... (${file.name})</div>`;

            loadExcel(file, statusElement);
        }

        // ì—‘ì…€ íŒŒì‹± (í–¥ìƒëœ ë²„ì „)
        function loadExcel(file, statusElement) {
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });

                    let successCount = 0;
                    let errorCount = 0;

                    // 1. ì¸ë ¥êµ¬ë¶„ ì‹œíŠ¸
                    if (workbook.Sheets['ì¸ë ¥êµ¬ë¶„']) {
                        const ws1 = workbook.Sheets['ì¸ë ¥êµ¬ë¶„'];
                        const workerData = XLSX.utils.sheet_to_json(ws1);
                        workers = workerData.map(r => ({
                            team: r['íŒ€ëª…'] || r['íŒ€'] || '',
                            id: r['ID'] || r['id'] || '',
                            name: r['ì´ë¦„'] || r['ì„±ëª…'] || '',
                            ip: r['IP'] || r['ip'] || ''
                        })).filter(w => w.team && w.id && w.name && w.ip);
                        successCount++;
                    }

                    // 2. ì—°ì°¨ ì‹œíŠ¸
                    if (workbook.Sheets['ì—°ì°¨']) {
                        const ws2 = workbook.Sheets['ì—°ì°¨'];
                        const leaveRows = XLSX.utils.sheet_to_json(ws2);
                        leaveStatus = {};
                        leaveRows.forEach(r => {
                            if (r['ID'] && r['ì¼ì'] && r['ì—°ì°¨']) {
                                leaveStatus[`${r['ID']}_${r['ì¼ì']}`] = r['ì—°ì°¨'];
                            }
                        });
                        successCount++;
                    }

                    // 3. ì‘ì—…ëŸ‰ ì‹œíŠ¸
                    if (workbook.Sheets['ì‘ì—…ëŸ‰']) {
                        const ws3 = workbook.Sheets['ì‘ì—…ëŸ‰'];
                        const workRows = XLSX.utils.sheet_to_json(ws3);
                        
                        workQueues = {
                            'ì‚¬ì—…ê´€ë¦¬íŒ€': [],
                            'ìŠ¤ìº”íŒ€': [],
                            'ì´ë¯¸ì§€ë³´ì •íŒ€': [],
                            'TOCíŒ€': [],
                            'ì ê²€1íŒ€': [],
                            'ì ê²€2íŒ€': [],
                            'ì ê²€3íŒ€': []
                        };

                        // ëª¨ë“  íŒ€ì— ê¸°ë³¸ ì‘ì—… ìƒì„± (ì‘ì—…ëŸ‰ ì‹œíŠ¸ê°€ ì—†ì–´ë„ ì‘ì—… ë°°ì •ì„ ìœ„í•´)
                        const defaultWorkCount = 50; // ê° íŒ€ë‹¹ ê¸°ë³¸ 50ê°œ ì‘ì—…
                        Object.keys(workQueues).forEach(team => {
                            for (let i = 1; i <= defaultWorkCount; i++) {
                                const teamCode = {
                                    'ì‚¬ì—…ê´€ë¦¬íŒ€': 'MG',
                                    'ìŠ¤ìº”íŒ€': 'SC',
                                    'ì´ë¯¸ì§€ë³´ì •íŒ€': 'IM',
                                    'TOCíŒ€': 'TC',
                                    'ì ê²€1íŒ€': 'C1',
                                    'ì ê²€2íŒ€': 'C2',
                                    'ì ê²€3íŒ€': 'C3'
                                }[team];
                                workQueues[team].push(`${teamCode}${String(i).padStart(4, '0')}`);
                            }
                        });

                        workRows.forEach(r => {
                            if (r['ì´ë¯¸ì§€ ë³´ì • ëŒ€ìƒ ì œì–´ë²ˆí˜¸']) workQueues['ì´ë¯¸ì§€ë³´ì •íŒ€'].push(r['ì´ë¯¸ì§€ ë³´ì • ëŒ€ìƒ ì œì–´ë²ˆí˜¸']);
                            if (r['TOC ëŒ€ìƒ ì œì–´ë²ˆí˜¸']) workQueues['TOCíŒ€'].push(r['TOC ëŒ€ìƒ ì œì–´ë²ˆí˜¸']);
                            if (r['ì ê²€1ì°¨ ì œì–´ë²ˆí˜¸']) workQueues['ì ê²€1íŒ€'].push(r['ì ê²€1ì°¨ ì œì–´ë²ˆí˜¸']);
                            if (r['ì ê²€2ì°¨ ì œì–´ë²ˆí˜¸']) workQueues['ì ê²€2íŒ€'].push(r['ì ê²€2ì°¨ ì œì–´ë²ˆí˜¸']);
                            if (r['ì ê²€3ì°¨ ì œì–´ë²ˆí˜¸']) workQueues['ì ê²€3íŒ€'].push(r['ì ê²€3ì°¨ ì œì–´ë²ˆí˜¸']);
                        });
                        successCount++;
                    }

                    if (successCount === 0) {
                        throw new Error('í•„ìš”í•œ ì‹œíŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. (ì¸ë ¥êµ¬ë¶„, ì—°ì°¨, ì‘ì—…ëŸ‰ ì‹œíŠ¸ í•„ìš”)');
                    }

                    // UI ì—…ë°ì´íŠ¸
                    updateWorkerTable();
                    updateAttendanceTable();
                    updateWorkStatus();
                    updateQueueStatus();
                    startWorkAssignments();

                    statusElement.innerHTML = `
                        <div class="success-message">âœ… ì—…ë¡œë“œ ì™„ë£Œ!</div>
                        <div class="file-info">íŒŒì¼: ${file.name}</div>
                        <div class="file-info">ì²˜ë¦¬ëœ ì‹œíŠ¸: ${successCount}ê°œ</div>
                        <div class="file-info">ì‘ì—…ì: ${workers.length}ëª…</div>
                    `;

                    // ì‘ì—… ëŒ€ê¸°ì—´ ìƒíƒœ í‘œì‹œ
                    document.getElementById('workQueueStatus').style.display = 'block';

                } catch (error) {
                    statusElement.innerHTML = `<div class="error-message">âŒ ì²˜ë¦¬ ì˜¤ë¥˜: ${error.message}</div>`;
                }
            };
            
            reader.onerror = function() {
                statusElement.innerHTML = `<div class="error-message">âŒ íŒŒì¼ì„ ì½ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</div>`;
            };
            
            reader.readAsArrayBuffer(file);
        }

        // ì‘ì—… ë°°ì • ì‹œì‘ (20~40ë¶„ ê°„ê²©)
        function startWorkAssignments() {
            // ê¸°ì¡´ íƒ€ì´ë¨¸ ì •ë¦¬
            Object.values(workTimers).forEach(timer => clearInterval(timer));
            workTimers = {};

            Object.keys(workQueues).forEach(team => {
                if (workQueues[team].length > 0) {
                    workTimers[team] = setInterval(() => {
                        if (allOffDuty || workStopped) return;
                        
                        const teamWorkers = workers.filter(w => w.team === team && isWorkerAvailable(w));
                        if (teamWorkers.length > 0 && workQueues[team].length > 0) {
                            const serial = workQueues[team].shift();
                            const worker = teamWorkers[Math.floor(Math.random() * teamWorkers.length)];
                            assignWork(team, worker, serial);
                        }
                    }, (Math.random() * 20 + 20) * 60 * 1000); // 20-40ë¶„
                }
            });
        }

        // ì‘ì—…ì ê°€ìš©ì„± í™•ì¸
        function isWorkerAvailable(worker) {
            const attendance = generateAttendance(worker);
            return attendance.status !== 'ì—°ì°¨' && attendance.status !== 'í‡´ê·¼';
        }

        // ì‘ì—… ë°°ì •
        function assignWork(team, worker, serial) {
            currentWorkerAssignments[worker.id] = {
                team: team,
                serial: serial,
                assignedAt: new Date()
            };
            
            updateWorkerTable();
            updateWorkStatus();
            updateQueueStatus();
            
            // ì¼ì • ì‹œê°„ í›„ ì‘ì—… ì™„ë£Œ ì²˜ë¦¬ (30ë¶„~2ì‹œê°„)
            setTimeout(() => {
                if (currentWorkerAssignments[worker.id] && currentWorkerAssignments[worker.id].serial === serial) {
                    delete currentWorkerAssignments[worker.id];
                    updateWorkerTable();
                    updateWorkStatus();
                }
            }, (Math.random() * 90 + 30) * 60 * 1000); // 30ë¶„~2ì‹œê°„
        }

        // ì‘ì—… ëŒ€ê¸°ì—´ ìƒíƒœ ì—…ë°ì´íŠ¸
        function updateQueueStatus() {
            const queueContent = document.getElementById('queueStatusContent');
            if (!queueContent) return;

            let content = '';
            
            Object.keys(workQueues).forEach(team => {
                const count = workQueues[team].length;
                content += `
                    <div class="queue-info">
                        <span class="queue-team">${team}</span>
                        <span class="queue-count">${count}ê°œ ëŒ€ê¸°</span>
                    </div>
                `;
            });

            queueContent.innerHTML = content;
        }
        
        // í˜ì´ì§€ ì „í™˜
        function showPage(pageName) {
            // ëª¨ë“  í˜ì´ì§€ ìˆ¨ê¸°ê¸°
            document.querySelectorAll('.page-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // ëª¨ë“  ë©”ë‰´ ì•„ì´í…œ ë¹„í™œì„±í™”
            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // ì„ íƒí•œ í˜ì´ì§€ í‘œì‹œ
            if (pageName === 'workers') {
                document.getElementById('workersPage').classList.add('active');
                document.querySelectorAll('.menu-item')[0].classList.add('active');
            } else if (pageName === 'attendance') {
                document.getElementById('attendancePage').classList.add('active');
                document.querySelectorAll('.menu-item')[1].classList.add('active');
            } else if (pageName === 'admin' && isAdmin) {
                document.getElementById('adminPage').classList.add('active');
                document.querySelector('.admin-menu').classList.add('active');
            }
        }
        
        // ì„œë¸Œë©”ë‰´ í† ê¸€
        function toggleSubmenu(menuItem) {
            const submenu = document.getElementById('workSubmenu');
            const arrow = menuItem.querySelector('.arrow');
            
            submenu.classList.toggle('show');
            arrow.classList.toggle('down');
            
            // ì„œë¸Œë©”ë‰´ê°€ ì—´ë¦¬ë©´ ì „ì²´ í˜„í™© í‘œì‹œ
            if (submenu.classList.contains('show')) {
                showWorkTeam('all');
            }
        }
        
        // íŒ€ë³„ ì‘ì—… í˜„í™© í‘œì‹œ
        function showWorkTeam(team) {
            // í˜ì´ì§€ ì „í™˜
            document.querySelectorAll('.page-section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById('workPage').classList.add('active');
            
            // ë©”ë‰´ í™œì„±í™”
            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelectorAll('.menu-item')[2].classList.add('active');
            
            // ì„œë¸Œë©”ë‰´ ì•„ì´í…œ í™œì„±í™”
            document.querySelectorAll('.submenu-item').forEach(item => {
                item.classList.remove('active');
            });
            event.target.classList.add('active');
            
            currentTeamView = team;
            
            // ì œëª© ì—…ë°ì´íŠ¸
            const titles = {
                'all': 'ì „ì²´ ì‘ì—… í˜„í™©',
                'management': 'ì‚¬ì—…ê´€ë¦¬íŒ€ ì‘ì—… í˜„í™©',
                'scan': 'ìŠ¤ìº”íŒ€ ì‘ì—… í˜„í™©',
                'image': 'ì´ë¯¸ì§€ë³´ì •íŒ€ ì‘ì—… í˜„í™©',
                'toc': 'TOCíŒ€ ì‘ì—… í˜„í™©',
                'check1': 'ì ê²€1íŒ€ ì‘ì—… í˜„í™©',
                'check2': 'ì ê²€2íŒ€ ì‘ì—… í˜„í™©',
                'check3': 'ì ê²€3íŒ€ ì‘ì—… í˜„í™©'
            };
            
            const descriptions = {
                'all': 'ëª¨ë“  íŒ€ì˜ ì‘ì—… ì§„í–‰ ìƒí™©',
                'management': 'ì‚¬ì—…ê´€ë¦¬íŒ€ ì‘ì—… ì§„í–‰ ìƒí™©',
                'scan': 'ìŠ¤ìº”íŒ€ ì‘ì—… ì§„í–‰ ìƒí™©',
                'image': 'ì´ë¯¸ì§€ë³´ì •íŒ€ ì‘ì—… ì§„í–‰ ìƒí™©',
                'toc': 'TOCíŒ€ ì‘ì—… ì§„í–‰ ìƒí™©',
                'check1': 'ì ê²€1íŒ€ ì‘ì—… ì§„í–‰ ìƒí™©',
                'check2': 'ì ê²€2íŒ€ ì‘ì—… ì§„í–‰ ìƒí™©',
                'check3': 'ì ê²€3íŒ€ ì‘ì—… ì§„í–‰ ìƒí™©'
            };
            
            document.getElementById('workPageTitle').textContent = titles[team];
            document.getElementById('workPageDesc').textContent = descriptions[team];
            
            updateWorkStatus();
        }
        
        // ëœë¤ ì‹œê°„ ìƒì„±
        function getRandomTime(startHour, startMin, endHour, endMin) {
            const start = startHour * 60 + startMin;
            const end = endHour * 60 + endMin;
            const randomMin = Math.floor(Math.random() * (end - start + 1)) + start;
            const hour = Math.floor(randomMin / 60);
            const min = randomMin % 60;
            return `${String(hour).padStart(2, '0')}:${String(min).padStart(2, '0')}`;
        }
        
        // ì¶œí‡´ê·¼ ì‹œê°„ ìƒì„±
        function generateAttendance(worker, date = new Date()) {
            const today = new Date();
            const todayStr = today.toISOString().split('T')[0]; // YYYY-MM-DD í˜•ì‹
            
            // ì—°ì°¨ ë°ì´í„°ì—ì„œ ì˜¤ëŠ˜ ë‚ ì§œì˜ ì—°ì°¨ ì •ë³´ í™•ì¸
            let todayLeaveStatus = null;
            Object.keys(leaveStatus).forEach(key => {
                const [workerId, leaveDate] = key.split('_');
                // ë‹¤ì–‘í•œ ë‚ ì§œ í˜•ì‹ ì²˜ë¦¬
                let formattedLeaveDate = leaveDate;
                if (leaveDate && !leaveDate.includes('-')) {
                    // ì—‘ì…€ì—ì„œ ìˆ«ìë¡œ ëœ ë‚ ì§œë¥¼ ë³€í™˜
                    const excelDate = new Date((leaveDate - 25569) * 86400 * 1000);
                    formattedLeaveDate = excelDate.toISOString().split('T')[0];
                }
                
                if (workerId === worker.id && formattedLeaveDate === todayStr) {
                    todayLeaveStatus = leaveStatus[key];
                }
            });
            
            // ìˆ˜ë™ ì„¤ì •ëœ ì—°ì°¨ë„ í™•ì¸
            const manualLeaveKey = `${worker.id}_${todayStr}`;
            if (leaveStatus[manualLeaveKey]) {
                todayLeaveStatus = leaveStatus[manualLeaveKey];
            }
            
            // í‡´ê·¼ ì‹œê°„ ì²´í¬ (ì˜¤í›„ 6ì‹œ ì´í›„)
            const currentHour = today.getHours();
            
            if (todayLeaveStatus) {
                if (todayLeaveStatus === 'ì—°ì°¨') {
                    return {name: worker.name, team: worker.team, checkIn: 'ì—°ì°¨', checkOut: 'ì—°ì°¨', status: 'ì—°ì°¨'};
                } else if (todayLeaveStatus === 'ì˜¤ì „ë°˜ì°¨') {
                    return {
                        name: worker.name,
                        team: worker.team,
                        checkIn: getRandomTime(13, 30, 14, 0),
                        checkOut: currentHour >= 18 ? getRandomTime(17, 50, 18, 10) : '-',
                        status: 'ì˜¤ì „ë°˜ì°¨'
                    };
                } else if (todayLeaveStatus === 'ì˜¤í›„ë°˜ì°¨') {
                    return {
                        name: worker.name,
                        team: worker.team,
                        checkIn: getRandomTime(8, 30, 9, 0),
                        checkOut: getRandomTime(14, 0, 14, 10),
                        status: 'ì˜¤í›„ë°˜ì°¨'
                    };
                }
            }
            
            return {
                name: worker.name,
                team: worker.team,
                checkIn: getRandomTime(8, 30, 9, 0),
                checkOut: currentHour >= 18 ? getRandomTime(17, 50, 18, 10) : '-',
                status: currentHour >= 18 ? 'í‡´ê·¼' : 'normal'
            };
        }
        
        // ì‘ì—…ì í…Œì´ë¸” ì—…ë°ì´íŠ¸
        function updateWorkerTable() {
            const tbody = document.getElementById('workerTableBody');
            tbody.innerHTML = '';
            
            let workingCount = 0;
            let leaveCount = 0;
            
            workers.forEach(worker => {
                const attendance = generateAttendance(worker);
                
                if (attendance.status === 'ì—°ì°¨' || attendance.status === 'ì˜¤ì „ë°˜ì°¨' || attendance.status === 'ì˜¤í›„ë°˜ì°¨') {
                    leaveCount++;
                } else if (attendance.status !== 'í‡´ê·¼') {
                    workingCount++;
                }
                
                const currentWork = currentWorkerAssignments[worker.id];
                
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${worker.team}</td>
                    <td>${worker.id}</td>
                    <td>${worker.name}</td>
                    <td>${worker.ip}</td>
                    <td>${attendance.status === 'ì—°ì°¨' ? 
                        '<span class="status-badge status-leave">ì—°ì°¨</span>' : 
                        attendance.status === 'ì˜¤ì „ë°˜ì°¨' ? 
                        '<span class="status-badge status-half">ì˜¤ì „ë°˜ì°¨</span>' : 
                        attendance.status === 'ì˜¤í›„ë°˜ì°¨' ? 
                        '<span class="status-badge status-half">ì˜¤í›„ë°˜ì°¨</span>' : 
                        attendance.status === 'í‡´ê·¼' ?
                        '<span style="color: #999;">í‡´ê·¼</span>' :
                        `<span style="color: #28a745;">ê·¼ë¬´ì¤‘</span>`
                    }</td>
                    <td>${currentWork ? 
                        `<span class="serial-number">${currentWork.serial}</span>` : 
                        '<span style="color: #999;">ëŒ€ê¸°ì¤‘</span>'
                    }</td>
                `;
            });
            
            // í†µê³„ ì—…ë°ì´íŠ¸
            document.getElementById('totalWorkers').textContent = workers.length;
            document.getElementById('workingCount').textContent = workingCount;
            document.getElementById('leaveCount').textContent = leaveCount;
        }
        
        // ì¶œí‡´ê·¼ í…Œì´ë¸” ì—…ë°ì´íŠ¸
        function updateAttendanceTable() {
            const tbody = document.getElementById('attendanceTableBody');
            tbody.innerHTML = '';
            
            workers.forEach(worker => {
                const attendance = generateAttendance(worker);
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${attendance.team}</td>
                    <td>${attendance.name}</td>
                    <td>${attendance.checkIn}</td>
                    <td>${attendance.checkOut}</td>
                    <td><span class="status-badge ${attendance.status === 'ì—°ì°¨' ? 'status-leave' : 
                        attendance.status === 'normal' ? '' : 'status-half'}">${
                        attendance.status === 'ì—°ì°¨' ? 'ì—°ì°¨' : 
                        attendance.status === 'ì˜¤ì „ë°˜ì°¨' ? 'ì˜¤ì „ë°˜ì°¨' : 
                        attendance.status === 'ì˜¤í›„ë°˜ì°¨' ? 'ì˜¤í›„ë°˜ì°¨' : 
                        attendance.status === 'í‡´ê·¼' ? 'í‡´ê·¼' : 'ì •ìƒ'
                    }</span></td>
                `;
            });
        }
        
        // ì‘ì—… í˜„í™© ì—…ë°ì´íŠ¸
        function updateWorkStatus() {
            const container = document.getElementById('workStatusContainer');
            container.innerHTML = '';
            
            // íŒ€ë³„ ê·¸ë£¹í™”
            const teamMap = {
                'management': 'ì‚¬ì—…ê´€ë¦¬íŒ€',
                'scan': 'ìŠ¤ìº”íŒ€',
                'image': 'ì´ë¯¸ì§€ë³´ì •íŒ€',
                'toc': 'TOCíŒ€',
                'check1': 'ì ê²€1íŒ€',
                'check2': 'ì ê²€2íŒ€',
                'check3': 'ì ê²€3íŒ€'
            };
            
            if (currentTeamView === 'all') {
                // ì „ì²´ í˜„í™© - íŒ€ë³„ë¡œ êµ¬ë¶„í•˜ì—¬ í‘œì‹œ
                const teamsToShow = ['ì‚¬ì—…ê´€ë¦¬íŒ€', 'ìŠ¤ìº”íŒ€', 'ì´ë¯¸ì§€ë³´ì •íŒ€', 'TOCíŒ€', 'ì ê²€1íŒ€', 'ì ê²€2íŒ€', 'ì ê²€3íŒ€'];
                
                teamsToShow.forEach(teamName => {
                    const teamWorkers = workers.filter(w => w.team === teamName);
                    const workingWorkers = teamWorkers.filter(w => {
                        const attendance = generateAttendance(w);
                        return attendance.status !== 'ì—°ì°¨' && attendance.status !== 'í‡´ê·¼';
                    });
                    
                    if (workingWorkers.length > 0) {
                        // íŒ€ ì„¹ì…˜ ìƒì„±
                        const teamSection = document.createElement('div');
                        teamSection.className = 'team-section';
                        
                        const teamHeader = document.createElement('div');
                        teamHeader.className = 'team-header';
                        teamHeader.innerHTML = `
                            <div class="team-title">${teamName}</div>
                            <div class="team-count">${workingWorkers.length}ëª…</div>
                        `;
                        teamSection.appendChild(teamHeader);
                        
                        // íŒ€ì› ê·¸ë¦¬ë“œ
                        const teamGrid = document.createElement('div');
                        teamGrid.className = 'work-status-grid';
                        
                        workingWorkers.forEach(worker => {
                            const div = document.createElement('div');
                            div.className = 'work-item';
                            const currentWork = currentWorkerAssignments[worker.id];
                            
                            // ì‚¬ì—…ê´€ë¦¬íŒ€ê³¼ ìŠ¤ìº”íŒ€ì€ í•­ìƒ "ì‘ì—…ì¤‘" ìƒíƒœë¡œ í‘œì‹œ
                            if (teamName === 'ì‚¬ì—…ê´€ë¦¬íŒ€' || teamName === 'ìŠ¤ìº”íŒ€') {
                                div.innerHTML = `
                                    <h4>${worker.name} (${worker.id})</h4>
                                    <p><strong>IP:</strong> ${worker.ip}</p>
                                    <p><strong>ìƒíƒœ:</strong> ì‘ì—…ì¤‘</p>
                                `;
                                teamGrid.appendChild(div);
                            } else if (currentWork) {
                                // ë‹¤ë¥¸ íŒ€ì€ ì‹¤ì œ ì‘ì—…ì´ ë°°ì •ëœ ê²½ìš°ì—ë§Œ í‘œì‹œ
                                div.innerHTML = `
                                    <h4>${worker.name} (${worker.id})</h4>
                                    <p><strong>IP:</strong> ${worker.ip}</p>
                                    <p><strong>ì‘ì—… ëŒ€ìƒ:</strong> <span class="serial-number">${currentWork.serial}</span></p>
                                `;
                                teamGrid.appendChild(div);
                            }
                        });
                        
                        teamSection.appendChild(teamGrid);
                        container.appendChild(teamSection);
                    }
                });
            } else {
                // íŠ¹ì • íŒ€ í˜„í™©
                const targetTeam = teamMap[currentTeamView];
                const teamWorkers = workers.filter(w => w.team === targetTeam);
                const workingWorkers = teamWorkers.filter(w => {
                    const attendance = generateAttendance(w);
                    return attendance.status !== 'ì—°ì°¨' && attendance.status !== 'í‡´ê·¼';
                });
                
                const teamGrid = document.createElement('div');
                teamGrid.className = 'work-status-grid';
                
                workingWorkers.forEach(worker => {
                    const div = document.createElement('div');
                    div.className = 'work-item';
                    const currentWork = currentWorkerAssignments[worker.id];
                    
                    // ì‚¬ì—…ê´€ë¦¬íŒ€ê³¼ ìŠ¤ìº”íŒ€ì€ í•­ìƒ "ì‘ì—…ì¤‘" ìƒíƒœë¡œ í‘œì‹œ
                    if (targetTeam === 'ì‚¬ì—…ê´€ë¦¬íŒ€' || targetTeam === 'ìŠ¤ìº”íŒ€') {
                        div.innerHTML = `
                            <h4>${worker.name} (${worker.id})</h4>
                            <p><strong>IP:</strong> ${worker.ip}</p>
                            <p><strong>ìƒíƒœ:</strong> ì‘ì—…ì¤‘</p>
                        `;
                        teamGrid.appendChild(div);
                    } else if (currentWork) {
                        // ë‹¤ë¥¸ íŒ€ì€ ì‹¤ì œ ì‘ì—…ì´ ë°°ì •ëœ ê²½ìš°ì—ë§Œ í‘œì‹œ
                        div.innerHTML = `
                            <h4>${worker.name} (${worker.id})</h4>
                            <p><strong>IP:</strong> ${worker.ip}</p>
                            <p><strong>ì‘ì—… ëŒ€ìƒ:</strong> <span class="serial-number">${currentWork.serial}</span></p>
                        `;
                        teamGrid.appendChild(div);
                    }
                });
                
                container.appendChild(teamGrid);
            }
        }

        // ì¶œí‡´ê·¼ ìƒíƒœ ì—…ë°ì´íŠ¸ (1ì´ˆë§ˆë‹¤)
        function updateAttendanceStatus() {
            const now = new Date();
            let activeWorkers = 0;

            workers.forEach(w => {
                const att = generateAttendance(w, now);
                if (att.status !== 'í‡´ê·¼' && att.status !== 'ì—°ì°¨') activeWorkers++;
            });

            if (activeWorkers === 0 && !allOffDuty) {
                allOffDuty = true; // ì „ì› í‡´ê·¼ â†’ ì‘ì—… ì¤‘ë‹¨
                console.log('ì „ì› í‡´ê·¼ìœ¼ë¡œ ì‘ì—… ì¤‘ë‹¨');
            } else if (activeWorkers > 0 && allOffDuty) {
                allOffDuty = false; // ì¶œê·¼ì ë°œìƒ â†’ ì‘ì—… ì¬ê°œ
                console.log('ì¶œê·¼ì ë°œìƒìœ¼ë¡œ ì‘ì—… ì¬ê°œ');
            }
        }

        // ì‘ì—… ì œì–´
        function toggleAllWork() {
            workStopped = !workStopped;
            const btn = document.getElementById('workToggleBtn');
            
            if (workStopped) {
                btn.textContent = 'ì „ì²´ ì‘ì—… ì¬ê°œ';
                btn.style.background = '#28a745';
                Object.values(workTimers).forEach(timer => clearInterval(timer));
            } else {
                btn.textContent = 'ì „ì²´ ì‘ì—… ì¤‘ë‹¨';
                btn.style.background = '#dc3545';
                startWorkAssignments();
            }
        }
        
        // ê´€ë¦¬ì ë¡œê·¸ì¸
        function adminLogin() {
            const password = document.getElementById('adminPassword').value;
            if (password === 'admin1234') {
                isAdmin = true;
                document.querySelector('.admin-menu').style.display = 'block';
                closeModal();
                showPage('admin');
            } else {
                alert('âŒ ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤.');
            }
        }
        
        // ëª¨ë‹¬ ì—´ê¸°/ë‹«ê¸°
        function openModal() {
            document.getElementById('loginModal').style.display = 'block';
        }
        
        function closeModal() {
            document.getElementById('loginModal').style.display = 'none';
            document.getElementById('adminPassword').value = '';
        }
        
        // í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤
        let keySequence = [];
        document.addEventListener('keydown', function(e) {
            keySequence.push(e.key);
            keySequence = keySequence.slice(-6);
            
            // Ctrl+Shift+M
            if (e.ctrlKey && e.shiftKey && e.key === 'M') {
                openModal();
                e.preventDefault();
            }
            
            // 'admin' ì…ë ¥
            if (keySequence.join('').toLowerCase().includes('admin')) {
                openModal();
                keySequence = [];
            }
        });
        
        // ì´ˆê¸°í™”
        function init() {
            updateTime();
            setupFileUpload();
            updateWorkerTable();
            updateAttendanceTable();
            updateWorkStatus();
            
            // 1ì´ˆë§ˆë‹¤ ì‹œê°„ ì—…ë°ì´íŠ¸ ë° ì¶œí‡´ê·¼ ìƒíƒœ í™•ì¸
            setInterval(() => {
                updateTime();
                updateAttendanceStatus();
                updateWorkerTable();
            }, 1000);
        }
        
        // í˜ì´ì§€ ë¡œë“œì‹œ ì´ˆê¸°í™”
        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>